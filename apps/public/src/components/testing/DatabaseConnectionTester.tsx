'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Database, CheckCircle, XCircle, AlertCircle, RefreshCw } from 'lucide-react';\nimport { useMockDatabase } from '../../../shared/services/mock-database.service';\n\ninterface DatabaseStatus {\n  component: string;\n  status: 'connected' | 'error' | 'testing';\n  message: string;\n  lastTested: Date;\n}\n\nexport function DatabaseConnectionTester() {\n  const [statuses, setStatuses] = useState<DatabaseStatus[]>([]);\n  const [testing, setTesting] = useState(false);\n  const { isConnected, error, MockDatabaseService } = useMockDatabase();\n\n  const testDatabaseConnections = async () => {\n    setTesting(true);\n    const testResults: DatabaseStatus[] = [];\n    \n    try {\n      // Test Venues API\n      const venuesStart = Date.now();\n      const venuesResponse = await fetch('/api/venues');\n      const venuesData = await venuesResponse.json();\n      testResults.push({\n        component: 'Venues API',\n        status: venuesResponse.ok && venuesData.success ? 'connected' : 'error',\n        message: venuesResponse.ok ? \n          `Found ${venuesData.count || 0} venues (${Date.now() - venuesStart}ms)` :\n          `HTTP ${venuesResponse.status}`,\n        lastTested: new Date()\n      });\n      \n      // Test Players API\n      const playersStart = Date.now();\n      const playersResponse = await fetch('/api/players');\n      const playersData = await playersResponse.json();\n      testResults.push({\n        component: 'Players API',\n        status: playersResponse.ok && playersData.success ? 'connected' : 'error',\n        message: playersResponse.ok ? \n          `Found ${playersData.count || 0} players (${Date.now() - playersStart}ms)` :\n          `HTTP ${playersResponse.status}`,\n        lastTested: new Date()\n      });\n      \n      // Test Tournaments API\n      const tournamentsStart = Date.now();\n      const tournamentsResponse = await fetch('/api/tournaments');\n      const tournamentsData = await tournamentsResponse.json();\n      testResults.push({\n        component: 'Tournaments API',\n        status: tournamentsResponse.ok ? 'connected' : 'error',\n        message: tournamentsResponse.ok ? \n          `Found ${Array.isArray(tournamentsData) ? tournamentsData.length : 0} tournaments (${Date.now() - tournamentsStart}ms)` :\n          `HTTP ${tournamentsResponse.status}`,\n        lastTested: new Date()\n      });\n      \n      // Test Age Restriction Service\n      try {\n        const { AgeRestrictionService } = await import('../../../shared/services/age-restriction.service');\n        const testResult = AgeRestrictionService.canPlayerEnterVenue(\n          { ageGroup: 'AGES_21_PLUS' } as any,\n          { ageRestriction: 'MINORS_ALLOWED_ALL_DAY' } as any,\n          new Date()\n        );\n        testResults.push({\n          component: 'Age Restriction Service',\n          status: testResult ? 'connected' : 'error',\n          message: testResult ? 'Service working correctly' : 'Service validation failed',\n          lastTested: new Date()\n        });\n      } catch (serviceError) {\n        testResults.push({\n          component: 'Age Restriction Service',\n          status: 'error',\n          message: `Service error: ${serviceError}`,\n          lastTested: new Date()\n        });\n      }\n      \n      // Test Mock Database Service\n      try {\n        const mockResult = await MockDatabaseService.findVenues();\n        testResults.push({\n          component: 'Mock Database Service',\n          status: mockResult.success ? 'connected' : 'error',\n          message: mockResult.success ? \n            `Mock service working (${mockResult.count} venues)` :\n            'Mock service failed',\n          lastTested: new Date()\n        });\n      } catch (mockError) {\n        testResults.push({\n          component: 'Mock Database Service',\n          status: 'error',\n          message: `Mock service error: ${mockError}`,\n          lastTested: new Date()\n        });\n      }\n      \n    } catch (error) {\n      console.error('Error testing database connections:', error);\n    }\n    \n    setStatuses(testResults);\n    setTesting(false);\n  };\n\n  useEffect(() => {\n    testDatabaseConnections();\n  }, []);\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'connected':\n        return <CheckCircle className=\"h-5 w-5 text-green-500\" />;\n      case 'error':\n        return <XCircle className=\"h-5 w-5 text-red-500\" />;\n      default:\n        return <AlertCircle className=\"h-5 w-5 text-yellow-500\" />;\n    }\n  };\n\n  const overallStatus = statuses.length > 0 ? \n    (statuses.every(s => s.status === 'connected') ? 'All systems connected' :\n     statuses.some(s => s.status === 'connected') ? 'Partial connectivity' :\n     'Connection issues detected') : 'Testing...';\n\n  return (\n    <div className=\"max-w-4xl mx-auto p-6\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg\">\n        <div className=\"px-6 py-4 border-b border-gray-200 dark:border-gray-700\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <Database className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                Database Connection Status\n              </h2>\n            </div>\n            <button\n              onClick={testDatabaseConnections}\n              disabled={testing}\n              className=\"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded-lg flex items-center gap-2\"\n            >\n              <RefreshCw className={`h-4 w-4 ${testing ? 'animate-spin' : ''}`} />\n              {testing ? 'Testing...' : 'Test Again'}\n            </button>\n          </div>\n          <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-2\">\n            {overallStatus}\n          </p>\n        </div>\n        \n        <div className=\"p-6\">\n          <div className=\"space-y-4\">\n            {statuses.map((status, index) => (\n              <div key={index} className=\"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                <div className=\"flex items-center gap-3\">\n                  {getStatusIcon(status.status)}\n                  <div>\n                    <h3 className=\"font-medium text-gray-900 dark:text-white\">\n                      {status.component}\n                    </h3>\n                    <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                      {status.message}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"text-right text-sm text-gray-500 dark:text-gray-400\">\n                  {status.lastTested.toLocaleTimeString()}\n                </div>\n              </div>\n            ))}\n          </div>\n          \n          {statuses.length === 0 && !testing && (\n            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n              No test results available. Click \"Test Again\" to run diagnostics.\n            </div>\n          )}\n          \n          {testing && (\n            <div className=\"text-center py-8\">\n              <RefreshCw className=\"h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400 mb-2\" />\n              <p className=\"text-gray-600 dark:text-gray-400\">Testing database connections...</p>\n            </div>\n          )}\n        </div>\n        \n        <div className=\"px-6 py-4 bg-gray-50 dark:bg-gray-700 rounded-b-lg\">\n          <div className=\"text-xs text-gray-600 dark:text-gray-400\">\n            <p className=\"mb-2\">\n              <strong>Status Information:</strong>\n            </p>\n            <ul className=\"list-disc list-inside space-y-1 ml-4\">\n              <li>✅ <strong>Connected:</strong> Component is working with database/API</li>\n              <li>❌ <strong>Error:</strong> Component has connection issues</li>\n              <li>⚠️ <strong>Testing:</strong> Connection test in progress</li>\n            </ul>\n            <p className=\"mt-4 text-gray-500\">\n              This tool tests the integration between React components and database operations. \n              It verifies that the age restriction system components can properly connect to data sources.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"